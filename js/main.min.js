"use strict";const styles={greater100:{iconShape:"doughnut",borderWidth:5,borderColor:"#009a4b"},range40To100:{iconShape:"doughnut",borderWidth:5,borderColor:"#FFEA00"},range20To40:{iconShape:"doughnut",borderWidth:5,borderColor:"#F08000"},lower20:{iconShape:"doughnut",borderWidth:5,borderColor:"#FF0000"},noData:{iconShape:"doughnut",borderWidth:5,borderColor:"#8A90B4"}},state={overLayers:{},baseLayers:{},center:[23.7035,120.8255]},initMaps=mapId=>{state.map=L.map(mapId,{zoom:8,center:state.center,zoomControl:!0,attributionControl:!1}),state.baseLayers["國土測繪通用版電子地圖"]=L.tileLayer("http://wmts.nlsc.gov.tw/wmts/EMAP/default/EPSG:3857/{z}/{y}/{x}",{attribution:'<a href="https://maps.nlsc.gov.tw/">國土測繪圖資服務雲</a>'}).addTo(state.map),state.sidebar=L.control.sidebar({closeButton:!0,autopan:!0,container:"sidebar",position:"left"}).addTo(state.map).open("home")},initGeoJsonPointLayer=()=>{state.overLayers["健保藥局庫存"]=L.geoJson(null,{onEachFeature:(feature,layer)=>{layer.bindTooltip((layer=>`<b>藥局：</b>${layer.feature.properties.name}<br>\n                    <b>電話：</b>${layer.feature.properties.phone}<br>\n\t\t\t\t    <b>地址：</b>${layer.feature.properties.address}<br>\n                    <b>目前庫存：</b>${layer.feature.properties.stock}<br>\n                    <b>資料時間：</b>${layer.feature.properties.updateTime}`),{direction:"right",className:"map-tooltip",offset:[0,0]}),feature.properties,layer.on("click",(()=>{}))},pointToLayer:(feature,latlng)=>{const stock=feature.properties.stock;let stockStyle;return stockStyle=stock>100?styles.greater100:stock>=40&&stock<=100?styles.range40To100:stock>=20&&stock<40?styles.range20To40:stock<20&&stock>=0?styles.lower20:styles.noData,L.marker(latlng,{icon:L.BeautifyIcon.icon(stockStyle)})}}).addTo(state.map)},loadBackend=()=>{fetch("https://vipcube.github.io/opendata.gov.tw/rapidTestStock.json").then((response=>response.json())).then((json=>{if(console.log(json),state.overLayers["健保藥局庫存"]){const layer=state.overLayers["健保藥局庫存"];layer.clearLayers(),layer.addData(json)}}))};